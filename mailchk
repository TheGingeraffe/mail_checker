#!/bin/bash

source ./common

# Iterates through output of get_addresses and pairs address names with 
# their domain in the domain_info array

# TODO look in passwd, shadow, and maildir for addresses then compare
# TODO find a way to capture domain list from /var/cpanel/userdata/$(whoami)/main

# Pairs address@domain

for i in $(get_addresses); do
  address=${i%@*}
  domain=${i#*@}
  domain_info[$domain]+="$address "
done

# Prints addresses in $HOME/mail under each domain

for domain in "${!domain_info[@]}"; do
  echo -e "\nThese addresses are present in ${HOME}/mail/${domain}:"
  echo
  for address in $(echo "${domain_info[$domain]}"); do
    echo "${address}@${domain}"
  done
done

